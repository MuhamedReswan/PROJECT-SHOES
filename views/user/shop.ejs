<%- include('../layout/user/header.ejs') -%>

<div class="pageWrapper">
    <%-include('../partials/userNavbar')-%>


    <style>
        .product-labels .lbl {
            font-size: 8px;
        }
    </style>

    
    <!--Body Content-->
    <div id="page-content">
    	<!--Collection Banner-->
    	<div class="collection-header">
			<div class="collection-hero">
        		<div class="collection-hero__image"><img class="blur-up lazyload" data-src="user/assets/images/cat-women1.jpg" src="user/assets/images/cat-women1.jpg" alt="Women" title="Women" /></div>
        		<div class="collection-hero__title-wrapper"><h1 class="collection-hero__title page-width">Shop Grid 4 Column</h1></div>
      		</div>
		</div>
        <!--End Collection Banner-->
        
        <div class="container" style="padding-top: 30px;">
        	<div class="row">
            	<!--Sidebar-->
            	<div class="col-12 col-sm-12 col-md-3 col-lg-3 sidebar filterbar">
                	<div class="closeFilter d-block d-md-none d-lg-none"><i class="icon icon anm anm-times-l"></i></div>
                	<div class="sidebar_tags">
                    	<!--Categories-->
                    
                
                       
                        <div class="sidebar_widget categories filter-widget">
                            <div class="widget-title"><h2>Categories</h2></div>
                            <div class="widget-content">
                                <% if(categoryData){ %>
                                    <% categoryData.forEach((category,index) =>{ %>
                                <ul class="sidebar_categories">
                                    <!-- <li class="level1 sub-level"><a href="#;" class="site-nav">Clothing</a> -->
                                    	<ul class="sublinks">
                                        	<li class="level2"><a href="#;" class="site-nav"><%= category.name %></a></li>
                                            
                                        </ul>
                                    <!-- </li> -->
                                </ul>
                                <% }) %>
                                <%}%>
                            </div>
                        </div>
                    
                        <!--Categories-->
                        <!--Price Filter-->
                        <div class="sidebar_widget filterBox filter-widget">
                            <div class="widget-title">
                            	<h2>Price</h2>
                            </div>
                            <form action="#" method="post" class="price-filter">
                                <div id="slider-range" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all">
                                	<div class="ui-slider-range ui-widget-header ui-corner-all"></div>
                                    <span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span>
                                    <span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span>
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <p class="no-margin"><input id="amount" type="text"></p>
                                    </div>
                                    <div class="col-6 text-right margin-25px-top">
                                        <button class="btn btn-secondary btn--small">filter</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <!--End Price Filter-->
    
            
                    </div>
                </div>
                <!--End Sidebar-->
                <!--Main Content-->
                <div class="col-12 col-sm-12 col-md-9 col-lg-9 main-col">
                	<div class="productList">
                    	<!--Toolbar-->
                        <button type="button" class="btn btn-filter d-block d-md-none d-lg-none"> Product Filters</button>
                    	<div class="toolbar">
                        	<div class="filters-toolbar-wrapper">
                            	<div class="row">
                                	<div class="col-4 col-md-4 col-lg-4 filters-toolbar__item collection-view-as d-flex justify-content-start align-items-center">
                                    	<a href="shop-left-sidebar.html" title="Grid View" class="change-view change-view--active">
                                        	<img src="user/assets/images/grid.jpg" alt="Grid" />
                                        </a>
                                        <a href="shop-listview.html" title="List View" class="change-view">
                                        	<img src="user/assets/images/list.jpg" alt="List" />
                                        </a>
                                    </div>
                                    <div class="col-4 col-md-4 col-lg-4 text-center filters-toolbar__item filters-toolbar__item--count d-flex justify-content-center align-items-center">
                                    	<span class="filters-toolbar__product-count">Showing:<%= productData.length %></span>
                                    </div>
                                    <div class="col-4 col-md-4 col-lg-4 text-right ">
                                    	<div class="filters-toolbar__item">
                                      		<label for="SortBy" class="hidden">Sort</label>
                                      		<select name="SortBy" id="SortBy" class="filters-toolbar__input filters-toolbar__input--sort">
                                                <option value="title-ascending"  selected="selected">Sort</option>
                                                <option>Best Selling</option>
                                                <option>Alphabetically, A-Z</option>
                                                <option>Alphabetically, Z-A</option>
                                                <option>Price, low to high</option>
                                                <option>Price, high to low</option>
                                                <option>Date, new to old</option>
                                                <option>Date, old to new</option>
                                      		</select>
                                      		<input class="collection-header__default-sort" type="hidden" value="manual">
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <!--End Toolbar-->
                        <div class="grid-products grid--view-items">
<% if(productData){ %>
   

                            <div class="row">
    
                                <% productData.forEach((product,index ) =>{ %>

   
                                <div class="col-6 col-sm-6 col-md-4 col-lg-3 item">
                                               <!-- start product image -->
                                               <div class="product-image">
                                                   <!-- start product image -->
                                                   <a href="/single-product?id=<%= product.id %>">
                                                       <!-- image -->
                                                       <img class="primary blur-up lazyload" id="mainImg1" data-src="user/assets/images/product-images/sharpedImages/<%= product.images[0] %> " src="user/assets/images/product-images/sharpedImages/<%= product.images[0] %> " alt="image" title="product" />
                                                       <!-- End image -->
                                                       <!-- Hover image -->
                                                       <img class="hover blur-up lazyload" id="mainImg2"  data-src="user/assets/images/product-images/sharpedImages/<%= product.images[1] %> " src="user/assets/images/product-images/sharpedImages/<%= product.images[1] %> " alt="image" title="product" />
                                                       <!-- End hover image -->

                                                       <% if(product.totalStock>0){%>   
                                                      <!-- product label -->
                                                       <div class="product-labels"><span class="lbl on-sale"><%= Math.floor(((product.price-product.offerPrice)/product.price)*100) %>% OFF</span></div>
                                                       <!-- End product label -->
                                                       <%}else{%>
                                                        <div class="product-labels "><span class="lbl on-sale">out of stock</span></div>
                                                        <%}%>

                                                   </a>
                                                   <!-- end product image -->
               
                                                   <!-- Start product button -->
                                                   <form class="variants add" action="/single-product?id=<%= product.id %>"  method="post">
                                                   <!-- <form class="variants add" action="/cart/<%=product._id%>" onclick="window.location.href='shop'" method="post"> -->
                                                       <button class="btn btn-addto-cart" type="submit">view Details</button>
                                                   </form>
                                                   <div class="button-set">
                                                       <a href="javascript:void(0)" title="Quick View" class="quick-view-popup quick-view" data-toggle="modal" data-target="#content_quickview">
                                                                   <i class="icon anm anm-search-plus-r"></i>
                                                               </a>
                                                       <div class="wishlist-btn">
                                                           <a class="wishlist add-to-wishlist"  title="Add to Wishlist" onclick="addToWishlist('<%=product._id%>')">
                                                               <i class="icon anm anm-heart-l"></i>
                                                           </a>
                                                       </div>
                                                   
                                                   </div>
                                                   <!-- end product button -->
                                               </div>
                                               <!-- end product image -->
               
                                               <!--start product details -->
                                               <div class="product-details text-center">
                                                   <!-- product name -->
                                                   <div class="product-name">
                                                       <a href="#"><%= product.name %></a>
                                                   </div>
                                                   <div class="product-brand">
                                                    <a href="#"><%= product.brand %></a>
                                                </div>
                                                   <!-- End product name -->
                                                   <!-- product price -->
                                                   <div class="product-price">
                                                       <span class="old-price"><%= product.price %></span>
                                                       <span class="price"><%= product.offerPrice %></span>
                                                   </div>
                                                   <!-- End product price -->
                                                   
                                                   <div class="product-review">
                                                       <i class="font-13 fa fa-star"></i>
                                                       <i class="font-13 fa fa-star"></i>
                                                       <i class="font-13 fa fa-star"></i>
                                                       <i class="font-13 fa fa-star-o"></i>
                                                       <i class="font-13 fa fa-star-o"></i>
                                                   </div>
                                                   <!-- Variant -->
                                                   <ul class="swatches">
                                                    <% for(i=0; i<4; i++){ %>
                                                      <a href="/single-product"> <li id="fourimg" class="swatch medium rounded" ><img src="user/assets/images/product-images/sharpedImages/<%= product.images[i] %>" alt="image <%=i+1%>"  /></li>
                                                        <%}%></a>
                                                    </ul>
                                                   <!-- End Variant -->
                                               </div>
                                               <!-- End product details -->
                                           </div>
                                           <% }) %>
                        </div>
                    </div>
                    <%}else{%>
                        <div class="row text-center">
<h3>NO PRODUCTS AVAILABLE NOW</h3>
                        </div>
                        <%}%>
                        <%# async: true %>
                    </div>
                    <div class="infinitpaginOuter">
                        <div class="infinitpagin">	
                            <a href="#" class="btn loadMore">Load More</a>
                        </div>
                    </div>
                </div>
                <!--End Main Content-->
            </div>
        </div>
        
    </div>
    <!--End Body Content-->

    
    <!--Footer-->
    <%-include('../partials/userBodyFooter.ejs')-%>
    <!--End Footer-->
    
    <!--Scoll Top-->
    <span id="site-scroll"><i class="icon anm anm-angle-up-r"></i></span>
    <!--End Scoll Top-->
    


    <script>
        function addToWishlist(productId){
            console.log('im add to wishlist function');//--------------
let data = {productId:productId}
console.log('data',data)//-------------
$.ajax({
    type:'post',
    url:'/add-to-wishlist',
    contentType:'application/json',
    data:JSON.stringify(data),
    success: (res)=>{

    },
    error:(error)=>{
console.log(error);
    }
})
        }
    </script>
    
     <!-- Including Jquery -->
     <script src="user/assets/js/vendor/jquery-3.3.1.min.js"></script>
     <script src="user/assets/js/vendor/jquery.cookie.js"></script>
     <script src="user/assets/js/vendor/modernizr-3.6.0.min.js"></script>
     <script src="user/assets/js/vendor/wow.min.js"></script>
     <!-- Including Javascript -->
     <script src="user/assets/js/bootstrap.min.js"></script>
     <script src="user/assets/js/plugins.js"></script>
     <script src="user/assets/js/popper.min.js"></script>
     <script src="user/assets/js/lazysizes.js"></script>
     <script src="user/assets/js/main.js"></script>
</div>

<%- include('../layout/user/footer.ejs') -%>
